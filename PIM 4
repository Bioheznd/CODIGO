
#include <stdio.h>
#include <stdlib.h>
#include <stdbool.h>
#include <string.h>
#include <ctype.h>
#include <stdbool.h>

#define MAX_SEAT_ROWS 2
#define SEATS_PER_ROW 24
#define MAX_PRESENTATIONS 1

int seatArray[MAX_SEAT_ROWS][SEATS_PER_ROW];
int rowNumber, seatNumber, ticketValue, showDate;
int ticketPrice = 30;

int main(int argc, char *argv[]) {
	int presentation;
	int dayOfWeek;
	
	while(true) {
		printf("Escolha a peça entre as opções abaixo\n");
		printf("\n");
		printf("1 - Espetáculo Teatral Corpo de Dor\n");
		printf("\n");
		scanf("%d", &presentation);
		
		if(presentation > MAX_PRESENTATIONS) {
			printf("\n");
			printf("NÃO DISPONÍVEL\n")
			printf("\n");
		} else {
			break;
		}
	}

	switch(seletorpeca) {
		case 1:
			printf("Peça selecionada: Espetáculo teatral Corpo de Dor.\n");
			printf("Preço R$ %d\n", ticketPrice);
			break;
	}
	printf("\n");
	
	printf("Digite o número referente ao dia da semana que deseja comprar\n");
	printf("\n");
	printf("|~~~~~~~~~~~~~~~~~~~~~~~~~~~~|\n");
	printf("| 1 - Domingo    01-Dez-2019 |\n");
	printf("| 2 - Segunda    02-Dez-2019 |\n");
	printf("| 3 - Terça      03-Dez-2019 |\n");
	printf("| 4 - Quarta     04-Dez-2019 |\n");
	printf("| 5 - Quinta     05-Dez-2019 |\n");
	printf("| 6 - Sexta      06-Dez-2019 |\n");
	printf("| 7 - Sábado     07-Dez-2019 |\n");
	printf("|____________________________|\n");
	scanf("%d", &dayOfWeek);
	
	while(dayOfWeek > 7) {
		printf("Escolha um dia da semana válido!\n");
		scanf("%d", &dayOfWeek);
	}
	
	switch(dayOfWeek) {
		case 1:
			printf("Domingo 01-Dez-2019\n");
			break;
		case 2:
			printf("Segunda-feira 02-Dez-2019\n");
			break;
	    case 3:
			printf("Terça-feira 03-Dez-2019\n");
			break;
		case 4: 
			printf("Quarta-feira 04-Dez-2019\n");
			break;
		case 5: 
			printf("Quinta-feira 05-Dez-2019\n");
			break;
		case 6: 
			printf("Sexta-feira 06-Dez-2019\n");
			break;
		case 7: 
			printf("Sábado 07-Dez-2019\n");
	}
	printf("\n");
	
	if(dayOfWeek == 3) {
		askForGratuityBenefit();
	} else {
		askForHalfEntranceBenefit();
	}
	
	printf("O valor do ingresso é R$ %d\n", ticketPrice);
	printf("\n");
	
	while(true) {
		printf("\n");
		printf("Escolha");
		printf("1 - Escolher Poltrona");
		printf("2 - Mostrar mapa de ocupação");
		printf("3 - Imprimir Ticket");
		scanf("%d", &opcao);
		
		switch(opcao) {
			case 1:
				chooseSeat();
                break;
			case 2:
				showSeatMap();
                break;
			case 3:
				printTicket();
                break;
		}                                                      
	}
	
	system("PAUSE");
    return 0;
}

void askForGratuityBenefit() {
	int haveGratuityBenefit;
	
	printf("\n");
	printf("O cliente possui benefício de Gratuidade de Ingresso? (1 - sim / 2 - nao) ");
	scanf("%d", &haveGratuityBenefit);
	
	if((bool)haveGratuityBenefit) {
		printf("OK, Benefício da GRATUIDADE foi aplicado.\n");
		printf("\n");
		
		ticketPrice = 0;
	} else {
		printf("Não.\n");
		printf("Prosseguindo...\n");
		printf("\n");
		
		askForHalfEntranceBenefit();
	}
}

void askForHalfEntranceBenefit() {
	int haveHalfEntranceBenefit;
	
	printf("\n");
	printf("O cliente possui benefício de meia entrada? (1 - sim / 2 - nao) ");
	scanf("%d", &haveHalfEntranceBenefit);
	
	if((bool)haveHalfEntranceBenefit) {
		printf("Sim.\n");
		printf("Insira o motivo.\n");
		printf("Não esqueça de solicitar a documentação.\n");
		printf("1 - Maior de 60 anos.\n");
		printf("2 - Professor da rede pública de ensino.\n");
		printf("3 - Criança de 2 à 12 anos.\n");
		printf("4 - Estudante.\n");
		scanf("%d", &halfEntranceReason);
		
		ticketPrice /= 2;
	} else {
		printf("Não.\n");
		printf("Prosseguindo...\n");
		printf("\n");
	}
}

void chooseSeat() {
	if(isTheaterFull()) {
		printf("\n");
		printf("Teatro lotado.");
	} else {
		printf("\n");
		printf("Escolha sua fileira ");
		scanf("%d", &rowNumber);
		
		printf("\n");
		printf("Número da poltrona (1 à 24): ");
		scanf("%d", &seatNumber);
		
		if(isSeatSelectedFree()) {
			acceptPaymentOrder();
		} else {
			recusePaymentOrder();
		}
	}
}

bool isTheaterFull() {
	int ocupedSeats = 0;
	
	for(int seatRow[] : seatArray) {
		for(int seat : seatRow) {
			ocupedSeats++;
		}
	}
	
	return ocupedSeats < (MAX_SEAT_ROWS * SEATS_PER_ROW);
}

bool isSeatSelectedFree() {
	return seatArray[rowNumber-1][seatNumber-1] == 0;
}

void acceptPaymentOrder() {
	seatArray[rowNumber-1][seatNumber-1] = 1;
	
	printf("\n");
	printf("Venda da poltrona %d - %d efetivada.\n", rowNumber, seatNumber);
}

void recusePaymentOrder() {
	printf("\n");
	printf("A poltrona %d - %d já está ocupada.\n", rowNumber, seatNumber);
}

void showSeatMap() {
	for(int i = 0; i < MAX_SEAT_ROWS; i++) {
		int seatRow[] = seatArray[i];
		
		printf("Fileira %d\n", i+1);
		
		for(int j = 0; j < SEATS_PER_ROW; j++) {
			if(isSeatFree(seatRow[j])) {
				printf("\t%d - Livre\n", j+1);
			} else {
				printf("\t%d - Ocupado\n", j+1);
			}
		}
		
		printf("\n");
	}
}

bool isSeatFree(int seat) {
	return seat == 0;
}

void printTicket() {
	printf("\n");
	printf("Ticket do Espetáculo Teatral Corpo de Dor\n");
	printf("\n");
	printf("Fileira %d\n", rowNumber);
	printf("Poltrona %d\n", seatNumber);
	printf("Valor do ingresso %d\n", ticketValue);
	printf("\n");
	printf("Data %d\n", showDate);
}



	

